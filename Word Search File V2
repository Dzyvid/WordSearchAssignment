// Last Updated: October, 7, 2019
// Status: Fixed and Finished
package Assignments;
public class wordsearch {
	//By: Joshua, Arunav, Wilson, David and Alden
	public static boolean check (String word, int row, int col, char[][] grid, char[][] record)
	{
		record[row][col] = '!';
		if (word.equals(""))
		{
			return true;
		}
		else if (row -1 < 0 ) // if first row
		{
			if (col-1 < 0) // if on first row left corner
			{
				if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if right
				{
					if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if right and below
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, below and below right
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
						else //if right and below
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right and below right
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
					else // if right
					{
						return true && check(word.substring(1), row, col+1, grid, record);
					}
				}
				else if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if below
				{
					if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below and below right
					{
						return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
					else // if below
					{
						return true && check(word.substring(1), row+1, col, grid, record);
					}
				}
				else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below right
				{
					return true && check(word.substring(1), row+1, col+1, grid, record);
				}
				else // if none
				{
					for (int i = 0; i < grid.length; i++)
					{
						for (int j = 0; j < grid.length; j++)
						{
							record[i][j] = ' ';
						}
					}
					return false;
				}
			}
			else if (col+1 == grid[0].length) // if on first row right corner
			{
				if (grid[row][col-1] == word.charAt(0) && record[row][col-1] != '!') // if left
				{
					if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if left and below
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, below and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
						else // if left and below
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left and below left
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if left
					{	
						return true && check(word.substring(1), row, col-1, grid, record); 
					}
				}
				else if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if below
				{
					if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if below and below left
					{
						return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if below
					{
						return true && check(word.substring(1), row+1, col, grid, record);
					}
				}
				else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if below left
				{
					return true && check(word.substring(1), row+1, col-1, grid, record);
				}
				else // if none
				{
					for (int i = 0; i < grid.length; i++)
					{
						for (int j = 0; j < grid.length; j++)
						{
							record[i][j] = ' ';
						}
					}
					return false;
				}
			}
			else // if on top side
			{
				if (grid[row][col-1] == word.charAt(0) && record[row][col-1] != '!') // if left
				{
					if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left and below left
					{
						if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if left, below left and right
						{
							if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if left, below left, right and below
							{
								if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, below left, right, below and below right
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record); 
								}
								else // if left, below left, right and below
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record);
								}
							}
							else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, below left, right and below right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
							else // if left, below left and right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record);
							}
						}
						else if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if left, below left and below
						{
							if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, below left, below and below right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
							else // if left, below left and below
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record);
							}
						}
						else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, below left and below right
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record) ||  check(word.substring(1), row+1, col+1, grid, record);
						}
						else // if left and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
					}
					else if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if left and right
					{
						if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if left, right and below
						{
							if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, below and below right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
							else // if left, right and below
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record);
							}
						}
						else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right and below right
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
						else // if left and right
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record);
						}
					}
					else if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if left and below
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, below and below right
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
						else // if left and below
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left and below right
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
					else // if left
					{
						return true && check(word.substring(1), row, col-1, grid, record);
					}
				}
				else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if below left
				{
					if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if below left and right
					{
						if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if below left, right and below
						{
							if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below left, right, below and below right
							{
								return check(word.substring(1), row+1, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record); 
							}
							else
							{
								return check(word.substring(1), row+1, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record);
							}
						}
						else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below left, right, below right
						{
							return check(word.substring(1), row+1, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
						else // if below left and right
						{
							return check(word.substring(1), row+1, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record);
						}
					}
					else if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if below left and below
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below left, below and below right
						{
							return check(word.substring(1), row+1, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
						else // if below left and below
						{
							return check(word.substring(1), row+1, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below left and below right
					{
						return check(word.substring(1), row+1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
					else // if below left
					{
						return true && check(word.substring(1), row+1, col-1, grid, record);
					}
				}
				else if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if right
				{
					if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if right and below
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, below and below right
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
						else // if right and below
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right and below right
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
					else // if right
					{
						return true && check(word.substring(1), row, col+1, grid, record);
					}
				}
				else if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if below
				{
					if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below and below right
					{
						return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
					else
					{
						return true && check(word.substring(1), row+1, col, grid, record);
					}
				}
				else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below right
				{
					return true && check(word.substring(1), row+1, col+1, grid, record);
				}
				else // if none
				{
					for (int i = 0; i < grid.length; i++)
					{
						for (int j = 0; j < grid.length; j++)
						{
							record[i][j] = ' ';
						}
					}
					return false;
				}
			}
		}
		else if (row + 1 == grid.length) // if on the last row
		{
			if (col-1 < 0) // if on the last row and the left corner
			{
				if (grid[row-1][col] == word.charAt(0) && record[row-1][col] != '!') // if above
				{
					if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above and above right
					{
						if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if above, above right and right
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row, col+1, grid, record);
						}
						else // if above and above right
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
						}
					}
					else if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if above and right
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row, col+1, grid, record);
					}
					else // if above
					{
						return true && check(word.substring(1), row-1, col, grid, record);
					}
				}
				else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above right
				{
					if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if above right and right
					{
						return check(word.substring(1), row-1, col, grid, record);
					}
					else // if above right
					{
						return true && check(word.substring(1), row-1, col+1, grid, record);
					}
				}
				else if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if right
				{
					return true && check(word.substring(1), row, col+1, grid, record);
				}
				else // if none
				{
					for (int i = 0; i < grid.length; i++)
					{
						for (int j = 0; j < grid.length; j++)
						{
							record[i][j] = ' ';
						}
					}
					return false;
				}
			}
			else if (col + 1 > 0) // if on the last row and the right corner
			{
				if (grid[row][col-1] == word.charAt(0) && record[row][col-1] != '!') // if left
				{
					if (grid[row-1][col] == word.charAt(0) && record[row-1][col] != '!') // if left and above
					{
						if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, above and above left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
						else // if left and above
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record);
						}
					}
					else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left and above left
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
					}
					else // if left
					{
						return true && check(word.substring(1), row, col-1, grid, record);
					}
				}
				else if (grid[row-1][col] == word.charAt(0) && record[row-1][col] != '!') // if above
				{
					if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above and above left
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
					}
					else // if above
					{
						return true && check(word.substring(1), row-1, col, grid, record);
					}
				}
				else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above left
				{
					return true && check(word.substring(1), row-1, col-1, grid, record);
				}
				else // if none
				{
					for (int i = 0; i < grid.length; i++)
					{
						for (int j = 0; j < grid.length; j++)
						{
							record[i][j] = ' ';
						}
					}
					return false;
				}
			}
			else // if on bottom side
			{
				if (grid[row-1][col] == word.charAt(0) && record[row-1][col] != '!') // if above
				{
					if (grid[row][col-1] == word.charAt(0) && record[row][col-1] != '!') // if above and left
					{
						if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if above, left and right
						{
							if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above, left, right and above left
							{
								if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above, left, right, above left and above right
								{
									return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row, col-1, grid, record) || check(word.substring(0), row, col+1, grid, record) || check(word.substring(0), row-1, col-1, grid, record) || check(word.substring(0), row-1, col+1, grid, record);  
								}
								else // if above, left, right and above left
								{
									return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
								}
							}
							else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above, left, right, above right
							{
								return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
							}
							else // if above, left and right
							{
								return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
							}
						}
						else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above, left and above left
						{
							if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') //if above, left, above left and above right
							{
								return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row-1, col+1, grid, record); 
							}
							else // if above, left and above left
							{
								return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
							}
						}
						else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above, left and above right 
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
						}
						else
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row, col-1, grid, record);
						}
					}
					else if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if above and right
					{
						if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above, right and above left
						{
							if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above, right, above left and above right
							{
								return check(word.substring(1), row-1, col, grid, record) || check(word.substring(0), row, col+1, grid, record) || check(word.substring(0), row-1, col-1, grid, record) || check(word.substring(0), row-1, col+1, grid, record); 
							}
							else // if above, right and above left
							{
								return check(word.substring(0), row-1, col, grid, record) || check(word.substring(0), row, col+1, grid, record) || check(word.substring(0), row-1, col-1, grid, record);
							}
						}
						else if(grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above, right and above right
						{	
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
						}
						else // if above and right
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row, col+1, grid, record);
						}
					}
					else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above and above left
					{
						if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above, above left and above right
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
						}
						else // if above and above left
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
					}
					else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above and above right
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(0), row-1, col+1, grid, record);
					}
					else // if none
					{
						for (int i = 0; i < grid.length; i++)
						{
							for (int j = 0; j < grid.length; j++)
							{
								record[i][j] = ' ';
							}
						}
						return false;
					}
				}
				else if (grid[row][col-1] == word.charAt(0) && record[row][col-1] != '!') // if left
				{
					if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if left and right
					{
						if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, right and above left
						{
							if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if left, right, above left and above right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row-1, col+1, grid, record); 
							}
							else // if left, right and above left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
							}
						}
						else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if left, right, above right
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(0), row, col+1, grid, record) || check(word.substring(0), row-1, col+1, grid, record);
						}
						else // if left and right
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record);
						}
					}
					else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left and above left
					{
						if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if left, above left and above right
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
						}
						else
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
					}
					else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if left and above right
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
					}
					else // if left
					{
						for (int i = 0; i < grid.length; i++)
						{
							for (int j = 0; j < grid.length; j++)
							{
								record[i][j] = ' ';
							}
						}
						return false;
					}
				}
				else if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if right
				{
					if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if right and above left
					{
						if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if right, above left and above right
						{
							return check(word.substring(0), row, col+1, grid, record) || check(word.substring(0), row-1, col-1, grid, record) || check(word.substring(0), row-1, col+1, grid, record);
						}
						else // if right and above left
						{
							return check(word.substring(0), row, col+1, grid, record) || check(word.substring(0), row-1, col-1, grid, record); 
						}
					}
					else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if right and above right
					{
						return check(word.substring(0), row, col+1, grid, record) || check(word.substring(0), row-1, col+1, grid, record);
					}
					else // if none
					{
						for (int i = 0; i < grid.length; i++)
						{
							for (int j = 0; j < grid.length; j++)
							{
								record[i][j] = ' ';
							}
						}
						return false;
					}
				}
				else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above left
				{
					if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above left and above right
					{
						return check(word.substring(0), row-1, col-1, grid, record) || check(word.substring(0), row-1, col+1, grid, record);
					}
					else // if above left
					{
						return true && check(word.substring(0), row-1, col-1, grid, record);
					}
				}
				else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above right
				{
					return true && check(word.substring(0), row-1, col+1, grid, record);
				}
				else // if none
				{
					for (int i = 0; i < grid.length; i++)
					{
						for (int j = 0; j < grid.length; j++)
						{
							record[i][j] = ' ';
						}
					}
					return false;
				}
			}
		}
		else if (col-1 < 0) // if on the left side
		{
			if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if right
			{
				if (grid[row-1][col] == word.charAt(0) && record[row-1][col] != '!') // if right and above
				{
					if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if right, above and below
					{
						if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if right, above, below and above right
						{
							if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above, below, above right and below right
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);  
							}
							else
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above, below and below right
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
						else // if right, above and below
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record);
						}
					}
					else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if right, above and above right
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above, above right and below right
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
						else // if right, above and above right
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record); 
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above and below right
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
					else // if right and above
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record);
					}
				
				}
				else if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if right and below
				{
					if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if right, below and above right
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, below, above right and below right
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
						else // if right, below and above right
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, below and below right
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
					else // if right and below
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record);
					}
				}
				else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if right and above right
				{
					if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above right and below right
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
					else
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
					}
				}
				else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right and below right
				{
					return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
				}
				else // if right
				{
					return true && check(word.substring(1), row, col+1, grid, record);
				}
			}
			else if (grid[row-1][col] == word.charAt(0) && record[row-1][col] != '!') // if above
			{
				if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if above and below
				{
					if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above, below and above right
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above, below, above right, below right
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
						else // if above, below and above right
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above, below and below right
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
					else // if above and below
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record);
					}
				}
				else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above and above right
				{
					if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above, above right and below right
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
					else // if above and above right
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
					}
				}
				else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above and below right
				{
					return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
				}
				else // if above
				{
					return true && check(word.substring(1), row-1, col, grid, record);
				}
			}
			else if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if below
			{
				if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if below and above right
				{
					if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below, above right and below right
					{
						return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
					else // if below and above right
					{
						return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
					}
				}
				else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below and below right
				{
					return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
				}
				else // if below
				{
					return true && check(word.substring(1), row+1, col, grid, record);
				}
			}
			else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above right
			{
				if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above right and below right
				{
					return check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
				}
				else // if above right
				{
					return true && check(word.substring(1), row-1, col+1, grid, record);
				}
			}
			else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below right
			{
				return true && check(word.substring(1), row+1, col+1, grid, record);
			}
			else // if none
			{
				for (int i = 0; i < grid.length; i++)
				{
					for (int j = 0; j < grid.length; j++)
					{
						record[i][j] = ' ';
					}
				}
				return false;
			}
		}
		else if (col+1 == grid[0].length) // if on the right side
		{
			if (grid[row][col-1] == word.charAt(0) && record[row][col-1] != '!') // if left
			{
				if (grid[row-1][col] == word.charAt(0) && record[row-1][col] != '!') // if left and above
				{
					if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if left, above and below
					{
						if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, above, below and above left
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, below, above left and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else // if left, above, below and above left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, below and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
						else
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record);
						}
					}
					else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, above and above left
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, above left and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
						else // if left, above and above left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above and below left
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if left and above
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record); 
					}
				}
				else if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if left and below
				{
					if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, below and above left
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, below, above left and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if left, below, above left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!')  // if left, below and below left
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if left and below
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record);
					}
				}
				else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // left and above left
				{
					if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above left and below left
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if left and above left
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
					}
				}
				else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left and below left
				{
					return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
				}
				else // if left
				{
					return true && check(word.substring(1), row, col-1, grid, record);
				}
			}
			else if (grid[row-1][col] == word.charAt(0) && record[row-1][col] != '!') // if above
			{
				if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if above and below
				{
					if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above, below and above left
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, below, above left and below left
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
						else // if above, below and above left
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, below and below left
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if above and below
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record);
					}
				}
				else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above and above left
				{
					if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, above left and below left
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if above and above left
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
					}
				}
				else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above and below left
				{
					return check(word.substring(1), row+1, col-1, grid, record);
				}
				else // if above
				{
					return true && check(word.substring(1), row-1, col, grid, record);
				}
			}
			else if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if below
			{
				if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if below and above left
				{
					if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if below, above left and below left
					{
						return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if below and above left
					{
						return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
					}
				}
				else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if below and below left
				{
					return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
				}
				else // if below
				{
					return true && check(word.substring(1), row+1, col, grid, record);
				}
			}
			else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above left
			{
				if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above left and below left
				{
					return check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
				}
				else // if above left
				{
					return true && check(word.substring(1), row-1, col-1, grid, record);
				}
			}
			else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if below left
			{
				return true && check(word.substring(1), row+1, col-1, grid, record);
			}
			else // if none
			{
				for (int i = 0; i < grid.length; i++)
				{
					for (int j = 0; j < grid.length; j++)
					{
						record[i][j] = ' ';
					}
				}
				return false;
			}
		}
		else // if normal
		{
			if (grid[row][col-1] == word.charAt(0) && record[row][col-1] != '!') // if left
			{
				if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if left and right
				{
					if (grid[row-1][col] == word.charAt(0) && record[row-1][col] != '!') // if left, right and above
					{
						if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if left, right, above and below
						{
							if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if left, right, above, below and above right
							{
								if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, right, above, below, above right and above left
								{
									if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, above, below, above right, above left and below right
									{
										if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above, below, above right, above left, below right and below left
										{
											return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);     
										}
										else // if left, right, above, below, above right, above left, below right
										{
											return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
										}
									}
									else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above, below, above right, above left, below left 
									{
										return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
									}
									else // if left, right, above, below, above right, above left
									{
										return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
									}
								}
								else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, above, below, above right and below right
								{
									if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, above, below, above right, below right and below left
									{
										return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);     
									}
									else // if left, right, above, below, above right and below right
									{
										return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
									}
								}
								else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above, below, above right and below left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
								}
								else // if left, right, above, below and above right
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);  
								}
							}
							else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, right, above, below and above left 
							{
								if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, above, below, above left and below right
								{
									if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above, below, above left, below right and below left
									{
										return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);    
									}
									else // if left, right, above, below, above left and below right
									{
										return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
									}
								}
								else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above, below, above left and below left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);    
								}
								else // if left, right, above, below and above left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record); 
								}
							}
							else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, above, below and below right
							{
								if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above, below, below right and below left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
								}
								else // if left, right, above, below and below right
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
								}
							}
							else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above, below and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else // if left, right, above and below
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record);
							}
						}
						else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if left, right, above and above right
						{
							if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, right, above, above right and above left
							{
								if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, above, above right, above left and below right
								{
									if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above, above right, above left, below right and below left
									{
										return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) ||  check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
									}
									else // if left, right, above, above right, above left and below right
									{
										return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) ||  check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
									}
								}
								else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above, above right, above left and below left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) ||  check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
								}
								else // if left, right, above, above right and above left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) ||  check(word.substring(1), row-1, col-1, grid, record);
								}
							}
							else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, above, above right and below right
							{
								if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above, above right, below right and below left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
								}
								else // if left, right, above, above right and below right 
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
								}
							}
							else // if left, right, above and above right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
							}
						}
						else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, right, above and above left
						{
							if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, above, above left and below right
							{
								if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above, above left, below right and below left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);   
								}
								else // if left, right, above, above left and below right
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
								}
							}
							else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above, above left and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
							}
						}
						else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, above and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above, below right and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
							}
							else // if left, right, above and below right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if left, right and above
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record);
						}
					}
					else if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if left, right and below
					{
						if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if left, right, below and above right
						{
							if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, right, below, above right and above left
							{
								if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, below, above right, above left and below right
								{
									if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, below, above right, above left, below right and below left
									{
										return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);     
									}
									else // if left, right, below, above right, above left and below right
									{
										return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
									}
								}
								else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, below, above right, above left and below left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
								}
								else // if left, right, below, above right and above left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
								}
							}
							else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, below, above right and below right
							{
								if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, below, above right, below right and below left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
								}
								else // if left, right, below, above right and below right
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
								}
							}
							else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, below, above right and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
							}
							else // if left, right, below and above right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
							}
						}
						else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, right, below and above left
						{
							if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, below, above left and below right
							{
								if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, below, above left, below right and below left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);   
								}
								else // if left, right, below, above left and below right
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
								}
							}
							else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, below, above left and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
							}
							else // if left, right, below and above left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
							}
						}
						else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, below and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, below, below right and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else // if left, right, below and below right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, below and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // left, right and below
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record);
						}
					}
					else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if left, right and above right
					{
						if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, right, above right and above left
						{
							if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, above right, above left and below right
							{
								if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above right, above left, below right and below left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);   
								}
								else // if left, right, above right, above left and below right
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);	
								}
							}
							else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // left, right, above right, above left and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
							}
							else // if left, right, above right and above left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
							}
						}
						else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, above right and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above right, below right and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else // if left, right, above right and below right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above right and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if left, right and above right
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
						}
					}
					else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, right and above left
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right, above left and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above left, below right and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else // if left, right, above left and below right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, above left, and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if left, right and above left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, right and below right
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right, below right and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if left, right and below right
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, right and below left
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record) ||check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if left and right
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row, col+1, grid, record);
					}
				}
				else if (grid[row-1][col] == word.charAt(0) && record[row-1][col] != '!') // if left and above
				{
					if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if left, above and below
					{
						if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if left, above, below and above right
						{
							if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, above, below, above right and above left
							{
								if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, above, below, above right, above left and below right
								{
									if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, below, above right, above left, below right and below left
									{
										return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);    
									}
									else // if left, above, below, above right, above left and below right
									{
										return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
									}
								}
								else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left above, below, above right, above left and below left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
								}
								else // if left, above, below, above right and above left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
								}
							}
							else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, above, below, above right and below right
							{
								if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, below, above right, below right and below left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);   
								}
								else // if left, above, below, above right and below right
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
								}
							}
							else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, below, above right and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
							}
							else // if left, above, below and above right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
							}
						}
						else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, above, below and above left
						{
							if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, above, below, above left and below right
							{
								if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, below, above left, below right and below left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
								}
								else // if left, above, below, above left, and below right
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
								}
							}
							else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, below, above left and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
							}
							else // if left, above, below, and above left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
							}
						}
						else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, above, below and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, below, below right and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else // if left, above, below and below right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, below and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
						else // if left, above and below
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record);
						}
					}
					else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if left, above and above right
					{
						if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, above, above right and above left
						{
							if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, above, above right, above left and below right
							{
								if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, above right, above left, below right and below left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
								}
								else // if left, above, above right, above left and below right
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
								}
							}
							else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, above right, above left and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
							}
							else // if left, above, above right and above left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
							}
						}
						else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, above, above right and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, above right, below right and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
							}
							else // if left, above, above right and below right 
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, above right and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
						else // if left, above and above right
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
						}
					}
					else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, above and above left
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, above, above left and below right
						{
							if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, above left, below right and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
							}
							else // if left, above, above left and below right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, above left and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
						else // if left, above and above left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, above and below right 
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above, below right and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
						else // if left, above and below right
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above and below left
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if left and above
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col, grid, record);
					}
				}
				else if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if left and below
				{
					if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if left, below and above right
					{
						if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, below, above right and above left
						{
							if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, below, above right, above left and below right
							{
								if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, below, above right, above left, below right and below left
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
								}
								else // if left, below, above right, above left and below right
								{
									return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
								}
							}
							else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, below, above right, above left and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
							}
							else // if left, below, above right and above left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
							}
						}
						else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, below, above right and below right 
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, below, above right, below right and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
							}
							else // if left, below, above right and below right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, below, above right and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if left, below and above right
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
						}
					}
					else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, below and above left
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, below, above left and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, below, above left, below right and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else // if left, below, above left and below right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, below, above left and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if left, below and above left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, below and below right
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, below, below right and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if left, below and below right
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, below and below left
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if left and below
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col, grid, record);
					}
				}
				else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if left and above right 
				{
					if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left, above right and above left
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, above right, above left and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above right, above left, below right and below left
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
							}
							else // if left, above right, above left and below right
							{
								return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above right, above left and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if left, above right and above left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, above right and below right 
					{
						if(grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above right, below right and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if left, above right and below right
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above right and below left
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if left and above right
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
					}
				}
				else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if left and above left
				{
					if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left, above left and below right
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above left, below right and below left
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if left, above left and below right
						{
							return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, above left and below left
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) ||check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if left and above left
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
					}
				}
				else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if left and below right
				{
					if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left, below right and below left
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if left and below right
					{
						return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
				}
				else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if left and below left
				{
					return check(word.substring(1), row, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
				}
				else // if left
				{
					return true && check(word.substring(1), row, col-1, grid, record);
				}
			}
			else if (grid[row][col+1] == word.charAt(0) && record[row][col+1] != '!') // if right
			{
				if (grid[row-1][col] == word.charAt(0) && record[row-1][col] != '!') // if right and above
				{
					if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if right, above and below
					{
						if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if right, above, below and above right
						{
							if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if right, above, below, above right and above left
							{
								if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above, below, above right, above left and below right
								{
									if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above, below, above right, above left, below right and below left
									{
										return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);    
									}
									else // if right, above, below, above right, above left and below right
									{
										return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
									}
								}
								else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above, below, above right, above left and below left
								{
									return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
								}
								else // if right, above, below, above right and above left
								{
									return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
								}
							}
							else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above, below, above right and below right
							{
								if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above, below, above right, below right and below left
								{
									return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
								}
								else // if right, above, below, above right and below right
								{
									return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
								}
							}
							else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above, below, above right and below left
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
							}
							else // if right, above, below and above right
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
							}
						}
						else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if right, above, below and above left
						{
							if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above, below, above left and below right
							{
								if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above, below, above left, below right, below left
								{
									return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);    
								}
								else // if right, above, below, above left and below right
								{
									return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
								}
							}
							else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above, below, above left and below left
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
							}
							else // if right, above, below and above left
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
							}
						}
						else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above, below and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above, below, below right and below left
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record); 
							}
							else // if right, above, below and below right
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above, below and below left
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
						else // if right, above and below
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record);
						}
					}
					else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if right, above and above right
					{
						if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if right, above, above right and above left
						{
							if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above, above right, above left and below right
							{
								if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above, above right, above left, below right and below left
								{
									return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
								}
								else // if right, above, above right, above left and below right
								{
									return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
								}
							}
							else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above, above right, above left and below left
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
							}
							else // if right, above, above right and above left
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
							}
						}
						else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above, above right and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above, above right, below right and below left
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else // if right, above, above right and below right
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above, above right and below left
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if right, above and above right
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
						}
					}
					else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if right, above and above left
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above, above left and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above, above left, below right and below left
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else // if right, above, above left and below right
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above, above left and below left
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
						else // if right, above and above left
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above and below right
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above, below right and below left
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if right, above and below right
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above and below left
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if right and above
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col, grid, record);
					}
				}
				else if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // right and below
				{
					if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if right, below and above right
					{
						if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if right, below, above right and above left
						{
							if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, below, above right, above left and below right
							{
								if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, below, above right, above left, below right and below left
								{
									return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);   
								}
								else // if right, below, above right, above left and below right
								{
									return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
								}
							}
							else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, below, above right, above left and below left
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
							}
							else // if right, below, above right and above left
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
							}
						}
						else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, below, above right and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, below, above right, below right and below left
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else // if right, below, above right and below right
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, below, above right and below left
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if right, below and above right
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
						}
					}
					else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if right, below and above left
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, below, above left and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, below, above left, below right and below left
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else // if right, below, above left and below right
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, below, above left and below left
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if right, below and above left
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, below and below right
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, below, below right and below left
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
						else // if right, below and below right
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, below, below left
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if right and below
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col, grid, record);
					}
				}
				else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if right and above right
				{
					if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if right, above right and above left
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above right, above left and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above right, above left, below right and below left
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else // if right, above right, above left and below right
							{
								return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above right, above left and below left
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
						else // if right, above right and above left
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above right and below right
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above right, below right and below left
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if right, above right and below right
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above right and below left
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if right and above right
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
					}
				}
				else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if right and above left
				{
					if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right, above left and below right
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above left, below right and below left
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if right, above left and below right
						{
							return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, above left and below left
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if right and above left
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
					}
				}
				else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if right and below right
				{
					if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right, below right and below left
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else
					{
						return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
				}
				else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if right and below left 
				{
					return check(word.substring(1), row, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
				}
				else // if right
				{
					return true && check(word.substring(1), row, col+1, grid, record);
				}
			}
			else if (grid[row-1][col] == word.charAt(0) && record[row-1][col] != '!') // if above
			{
				if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if above and below
				{
					if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above, below and above right
					{
						if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above, below, above right and above left
						{
							if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above, below, above right, above left and below right
							{
								if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, below, above right, above left, below right and below left
								{
									return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
								}
								else // if above, below, above right, above left and below right
								{
									return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
								}
							}
							else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, below, above right, above left and below left 
							{
								return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
							}
							else // if above, below, above right and above left
							{
								return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
							}
						}
						else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above, below, above right and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, below, above right, below right and below left
							{
								return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else // if above, below, above right and below right
							{
								return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, below, above right and below left
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
						else // if above, below and above right
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
						}
					}
					else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above, below and above left
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above, below, above left and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, below, above left, below right and below left
							{
								return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else // if above, below, above left and below right
							{
								return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);	
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, below, above left and below left
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if above, below and above left
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above, below and below right
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, below, below right and below left
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
						else // if above, below and below right
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, below and below left
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if above and below
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col, grid, record);
					}
				}
				else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above and above right
				{
					if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above, above right and above left
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above, above right, above left and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, above right, above left, below right and below left
							{
								return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);  
							}
							else // if above, above right, above left and below right
							{
								return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, above right, above left and below left
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
						}
						else // if above, above right and above left
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above, above right and below right
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, above right, below right and below left
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if above, above right and below right
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, above right and below left
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if above and above right
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
					}
				}
				else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above and above left
				{
					if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above, above left and below right
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, above left, below right and below left
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if above, above left and below right
						{
							return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, above left and below left
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if above and above left
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
					}
				}
				else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above and below right
				{
					if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above, below right and below left
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
					}
					else // if above and below right
					{
						return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
				}
				else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above and below left
				{
					return check(word.substring(1), row-1, col, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
				}
				else // if above
				{
					return true && check(word.substring(1), row-1, col, grid, record);
				}
			}
			else if (grid[row+1][col] == word.charAt(0) && record[row+1][col] != '!') // if below
			{
				if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if below and above right
				{
					if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if below, above right and above left
					{
						if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below, above right, above left and below right
						{
							if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if below, above right, above left, below right and below left
							{
								return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
							}
							else // if below, above right, above left and below right
							{
								return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
							}
						}
						else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if below, above right, above left and below left
						{
							return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if below, above right and above left
						{
							return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
						}
					}
					else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below, above right and below right
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if below, above right, below right and below left
						{
							return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if below, above right and below right
						{
							return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if below, above right and below left
					{
						return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if below and above right
					{
						return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col+1, grid, record);
					}
				}
				else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if below and above left
				{
					if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below, above left and below right
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if below, above left, below right and below left
						{
							return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if below, above left and below right 
						{
							return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if below, above left and below left
					{
						return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if below and above left
					{
						return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
					}
				}
				else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below and below right
				{
					if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if below, below right and below left
					{
						return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if below, below right
					{
						return check(word.substring(1), row+1, col, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
				}
				else // if below
				{
					return true && check(word.substring(1), row+1, col, grid, record);
				}
			}
			else if (grid[row-1][col+1] == word.charAt(0) && record[row-1][col+1] != '!') // if above right
			{
				if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above right and above left
				{
					if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above right, above left and below right
					{
						if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above right, above left, below right and below left
						{
							return check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record); 
						}
						else // if above right, above left and below right
						{
							return check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
						}
					}
					else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above right, above left and below left
					{
						return check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if above right and above left
					{
						return check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row-1, col-1, grid, record);
					}
				}
				else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above right and below right 
				{
					if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above right, below right and below left
					{
						return check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if above right and below right
					{
						return check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
				}
				else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above right and below left
				{
					return check(word.substring(1), row-1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
				}
				else
				{
					return true && check(word.substring(1), row-1, col+1, grid, record);
				}
			}
			else if (grid[row-1][col-1] == word.charAt(0) && record[row-1][col-1] != '!') // if above left
			{
				if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if above left and below right
				{
					if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above left, below right and below left
					{
						return check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
					}
					else // if above left and below right
					{
						return check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col+1, grid, record);
					}
				}
				else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if above left and below left
				{
					return check(word.substring(1), row-1, col-1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
				}
				else // if above left
				{
					return true && check(word.substring(1), row-1, col-1, grid, record);
				}
			}
			else if (grid[row+1][col+1] == word.charAt(0) && record[row+1][col+1] != '!') // if below right
			{
				if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if below right and below left
				{
					return check(word.substring(1), row+1, col+1, grid, record) || check(word.substring(1), row+1, col-1, grid, record);
				}
				else // if below right
				{
					return true && check(word.substring(1), row+1, col+1, grid, record);
				}
			}
			else if (grid[row+1][col-1] == word.charAt(0) && record[row+1][col-1] != '!') // if below left
			{
				return true && check(word.substring(1), row+1, col-1, grid, record);
			}
			else // if none
			{
				for (int i = 0; i < grid.length; i++)
				{
					for (int j = 0; j < grid.length; j++)
					{
						record[i][j] = ' ';
					}
				}
				return false;
			}
		}
	}
	public static boolean wordMaze1 (String word, char[][] grid)
	{
		final char[][] fill = new char[grid.length][grid[0].length];
		for (int i = 0; i < grid.length; i++)
		{
			for (int j = 0; j < grid.length; j++)
			{
				fill[i][j] = ' ';
			}
		}
		boolean result = false;
		if (word.equals(""))
		{
			return true;
		}
		else 
		{
			for (int i = 0; i < grid.length; i++)     
			{                    
				for (int j = 0; j < grid[0].length; j++)
				{
					if (word.charAt(0) == grid[i][j])
					{
						result = result || check(word.substring(1), i, j, grid, fill);
					}
				}
			}
			return result;
		}
	}
	public static void main(String[] args)
	{
		char[][]  board = {    
				{'A', 'P', 'P', 'L', 'E', 'S'},
				{'N', 'E', 'E', 'O', 'R', 'A'},
				{'I', 'A', 'E', 'A', 'N', 'G'},
				{'W', 'P', 'A', 'M', 'C', 'E'},
				{'I', 'N', 'A', 'B', 'I', 'H'},
				{'K', 'N', 'O', 'M', 'E', 'L'},
		};
		char[][] dim = {
				{'B', 'X', 'T'},
				{'R', 'A', 'G'},
				{'A', 'G', 'E'},
		};
		char[][]  dimmer = {
                {'B', 'G', 'L', 'E', 'A', 'P'},
                {'E', 'L', 'P', 'E', 'R', 'R'},
                {'U', 'D', 'U', 'D', 'U', 'O'},
                {'R', 'V', 'N', 'E', 'O', 'A'},
                {'E', 'A', 'R', 'M', 'N', 'M'},
                {'K', 'G', 'E', 'A', 'D', 'Y'},
        };
		System.out.println(wordMaze1("APPLES", board)); // true
		System.out.println(wordMaze1("PEACH", board)); // true
		System.out.println(wordMaze1("KIWI", board)); // true
		System.out.println(wordMaze1("LEMON", board)); // true
		System.out.println(wordMaze1("LIME", board)); // true
		System.out.println(wordMaze1("ORANGE", board)); // true
		System.out.println(wordMaze1("PINEAPPLES", board)); // true
		System.out.println(wordMaze1("PEAR", board)); // true
		System.out.println(wordMaze1("NAH", board)); // false
		System.out.println(wordMaze1("GARO", board)); // true
		System.out.println(wordMaze1("LEMONADE", board)); // false
		System.out.println(wordMaze1("GARAGE", dim)); // true
		System.out.println(wordMaze1("BAT", dim)); // true
		System.out.println(wordMaze1("RAT", dim)); // true
		System.out.println(wordMaze1("GARAT", dim) ); // true
		System.out.println(wordMaze1("TAAE", dim)); // false
		System.out.println(wordMaze1("DUEP", dimmer)); // true
        System.out.println (wordMaze1("VAER", dimmer)); // true
        System.out.println (wordMaze1("EPP", dimmer)); // false
	}
}
